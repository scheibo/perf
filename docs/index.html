<!doctype html>
<html lang=en>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="favicon.ico">
    <title>PERF</title>
    <style>
      #content {
        font-family: "Roboto", "Helvetica Neue", "Helvetica", "Arial", sans-serif;
        margin: 4em auto;
        max-width: 690px;
        line-height: 1.4em;
      }
      .formula {
        font-family: monospace;
        line-height: 1em;
      }
      div.formula {
        text-align: center;
        line-height: 1.3em;
      }
      h1 {
        margin-bottom: 0.5em;
      }
      h3 {
        color: #666;
      }
      .subtitle {
        font-size: 1.2em;
        color: #666;
        padding-bottom: 0.67em;
      }
      @media(max-width: 768px) {
        #content {
          font-size: 0.85em;
          max-width: 95%;
           margin: 2em auto;
        }
      }
    </style>
  </head>
  <body>
    <div id="content">
      <h1>PERF</h1>
      <div class="subtitle"><strong>P</strong>erformance
          <strong>E</strong>quivalency
          <strong>R</strong>ating
          <strong>F</strong>ormula</div>

      <h2 id="motivation">Motivation</h2>
      <p>
        The desire to rank and compare performances is universal across sports, be it to answer the
        question of whether Michael Jordan or LeBron James was the better basketball player, what
        1968 Jim Ryun’s mile time would be on a modern, synthetic track, or whether Katie Ledecky’s
        or Michael Phelps’ victories were more impressive. However, accurately comparing such
        performances is difficult and error prone - in all cases we must acknowledge that we will
        never be able to come up with a definitive answer, the best we can do is come up with
        metrics to guide the discussion and add a layer of scientific nuance to arguments.
      </p>

      <h2 id="background">Background</h2>
      <p>
        In swimming and track and field, the governing bodies (FINA and the IAAF, respectively)
        publish ‘points’ tables which can be used to rank performances. <a
        href="https://www.fina.org/sites/default/files/fina_points_table_2.pdf">FINA’s model</a> is
        based on comparing a event performance’s time to the current world record for that event (the
        ‘base’ performance) and applying a cubic function to arrive at a points total:
      </p>
      <div class="formula">
        <span>1000 (t<sub>WR</sub> / t)<sup>3</sup></span><br />
      </div>
      <p>
        The IAAF tables are based on Dr. Bojidar Spiriev’s Hungarian Scoring Table model which also
        calculates a score based on a base performance and several constants:
      </p>
      <div class="formula">
        <span>a (t - t<sub>b</sub>)<sup>c</sup></span><br />
      </div>
      <p>
        Where <span class="formula">a</span>, <span class="formula">t<sub>b</sub> </span> (the base
        performance) and <span class="formula">c</span> vary based on the event. Mick Bromilow’s “<a
        href="https://www.southernathletics.org.uk/assets/files/bromilowscoring.docx">Towards a
        fairer scoring system in athletics</a>” points out some issues and suggests improvements for
        this approach, and there are numerous other systems for evaluating or predicting performance in
        athletics (<a href="http://www.cs.uml.edu/~phoffman/xcinfo3.html">Gardner-Purdy points</a>,
        <a href="http://runsmartproject.com/calculator/">Daniels’ VDOT</a>,
        <a href="https://www.mcmillanrunning.com/ ">McMillan’s calculator</a>,
        <a href="http://myweb.lmu.edu/jmureika/track/mercier/instructions.html ">Mercier Score</a>),
        as well for adjusting for <a href="http://www.cs.uml.edu/~phoffman/wind.html">wind or altitude</a>.
      </p>
      <p>
        Comparing road cycling performance is significantly more difficult than swimming or
        athletics - road races take place over varying terrain and venues without any standard event
        distances. Importantly, weather conditions, in particular wind, have a substantially larger
        impact on performance than in other sports due to the speeds reached during competition and
        the quadratic nature of aerodynamic drag. As such, coming up with a formula to compare any
        given cycling performance with another is a nonstarter. However, if we restrict the domain
        to just comparing cycling <em>climbing</em> performance we can minimize the impact of many
        confounding factors and come up with a rough model to use for comparison purposes.
      </p>
      <p>
        Comparing cycling climbing performance is not a new idea - Michele Ferrari coined <a
        href="https://en.wikipedia.org/wiki/VAM_(bicycling)">VAM</a> (<em>velocità ascensionale
        media</em>) for comparing climbing speed, and Scott Richards &amp; Dr. Michael Puchowicz
        (<a href="https://veloclinic.com">Veloclinic</a>) have developed models
        (<a href="http://www.cyclismas.com/biscuits/a-different-approach-to-comparing-climbing-performances/">pVAM</a>,
        <a href="http://www.cyclismas.com/biscuits/introducing-pvgrad-yes-another-performance-meter/">pVGRAD</a>)
        for predicting climbing performance. Critics have used these models to argue whether or not a
        performance was ‘too good to be true’, but these allegations need to be taken with a grain of
        salt - the models are <a href="https://wattmatters.blog/home/2013/07/windbags.html">subject</a>
        <a href="https://wattmatters.blog/home/2010/07/ascent-rates-and-power-to-body-mass.html">to</a>
        <a href="http://djconnel.blogspot.com/2013/07/pvam-and-critical-power-model.html">flaws</a> and
        <a href="https://wattmatters.blog/home/2013/07/the-elusive-dopeometer.html">don’t</a>
        <a href="https://wattmatters.blog/home/2013/07/all-things-in-moderation-except-science.html">have</a>
        <a href="http://sportsscientists.com/2010/07/tour-power-output-reflections/">the</a>
        <a href="http://sportsscientists.com/2013/07/on-performance-analysis-common-sense-guided/">power</a>
        to be able to definitively brand a rider as a doper. More recently, the trend has shifting to
        relying on more scientifically backed models for quantifying cycling climbing performances.
      </p>
      <p>
        Puchowicz’s current approach relies on <a href="https://www.ncbi.nlm.nih.gov/pubmed/28121252">Martin’s mathematical model</a>
        for calculating cycling power, normalized for typical weight and conditions and corrected for
        altitude using <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5362642/">Townsend’s model</a>
        which relies on <a href="https://www.tandfonline.com/doi/abs/10.1080/00140136508930810">Monod and
        Scherrer’s seminal Critical Power (CP) model</a>. This can be used to calculate an estimated,
        normalized W/kg for a rider, which can then be compared to other performances of the same duration.
      </p>

      <h2 id="details">Details</h2>
      <p>
        Puchowicz’s work provides an excellent starting point for development of
        ‘<span class="formula">PERF</span>’, a formula for comparing cycling performance across various
        climbing durations. However, while Puchowicz’s approach is mainly concerned with estimating and
        comparing Tour de France climbing performances during the race, <span class="formula">PERF</span>
        aims to also rate one-off efforts by amateur cyclists. Like with FINA/IAAF points tables, a
        world class performance should rate around 1000 points, with less impressive performances
        earning progressively less points.
      </p>
      <p>
        <span class="formula">PERF</span> begins by deriving an altitude-adjusted estimation for
        normalized power-to-weight ratio (W/kg) based on Martin’s and Townsend’s models:
      </p>
      <div class="formula">
        <span>P<sub>AT</sub> = 1/2 ρ (C<sub>D</sub> A + F<sub>W</sub>) V<sub>a</sub><sup>2</sup> V<sub>G</sub></span><br />
        <span>P<sub>RR</sub> = V<sub>G</sub> cos[tan<sup>-1</sup>(G<sub>R</sub>)] C<sub>RR</sub> m<sub>T</sub> g</span><br />
        <span>P<sub>WB</sub> = V<sub>G</sub> (91 + 8.7 V<sub>G</sub>) / 1000</span><br />
        <span>P<sub>PE</sub> = V<sub>G</sub> m<sub>T</sub> g sin[tan<sup>-1</sup>(G<sub>R</sub>)]</span><br />
        <span>P<sub>KE</sub> = 1/2 (m<sub>T</sub> + I/r<sup>2</sup>) (V<sub>Gf</sub><sup>2</sup> - V<sub>Gi</sub><sup>2</sup>) / (t<sub>i</sub> - t<sub>f</sub>) </span><br />
        <span>P<sub>TOT</sub> = (P<sub>AT</sub> + P<sub>RR</sub> + P<sub>WB</sub> + P<sub>PE</sub> + P<sub>KE</sub>) / E<sub>c</sub></span><br />
        <br />
        <span>m<sub>T</sub> = m<sub>R</sub> + m<sub>B</sub></span><br />
        <span>ρ = (p<sub>0</sub> (1 - Lh/T<sub>0</sub>)<sup>(gM)/(RL)</sup>M)/(R(T<sub>0</sub> - Lh))</span><br />
        <br />
        <span>P<sub>ALT</sub> = P (0.0016x<sup>3</sup> + 0.0157x<sup>2</sup> + 0.027x + 1.0025)</span><br />
      </div>
      <p>
        Where <span class="formula">C<sub>RR</sub></span>, <span class="formula">E<sub>C</sub></span>,
        <span class="formula">g</span>, <span class="formula">F<sub>w</sub></span>, <span class="formula">T
        <sub>0</sub></span>, <span class="formula">p<sub>0</sub></span>, <span class="formula">L</span>,
        <span class="formula">M</span>, <span class="formula">R</span> are all constants with
        standard, well defined values, and the <span class="formula">m<sub>B</sub></span> is assumed
        to be <span class="formula">8 kg</span> (<span class="formula">6.8 kg</span> is the UCI limit
        for a bicycle, and then we need to account for clothes/helmet/shoes etc). Puchowicz simplifies
        these equations by assuming there is no change in kinetic energy (ie. the rider doesn’t need
        to accelerate into the base of the climb and thus <span class="formula">P<sub>KE</sub></span>
        is zero), assumes there is no wind (see ‘<a href="#considerations">Considerations</a>’ below),
        so air velocity is equal to the ground velocity (<span class="formula">V<sub>a</sub> =
        V<sub>G</sub></span>), when calculating <span class="formula">P<sub>AT</sub></span>, and
        derives the density of air (<span class="formula">ρ</span> ) based on the median altitude <span
        class="formula">h</span>. Puchowicz actually goes even further and ignores the contributions
        related to wheel bearing friction (<span class="formula">P<sub>WB</sub></span>) given that they
        are fairly negligible, but for completeness we leave this factor in the model for <span
        class="formula">PERF</span>.
      </p>
      <p>
        The aerodynamic drag (<span class="formula">C<sub>D</sub>A</span>) depends on the coefficient of
        drag (<span class="formula">C<sub>D</sub></span>) for a cyclist which from “Bicycling Science”
        (Wilson, 2004) can be <span class="formula">0.88</span>/<span class="formula">1.0</span>/<span
        class="formula">1.15</span> depending on the whether the rider is in the drops/hoods/tops
        respectively (Puchowicz uses <span class="formula">0.84</span>). For these same positions the
        respective frontal area (<span class="formula">A</span>) is
        <span class="formula">0.36</span>/<span class="formula">0.40</span>/<span class="formula">0.632</span>.
        Alternatively, area can be derived from the historically observed relationship between a rider’s height
        and weight and his frontal area in the drops:
      </p>
      <div class="formula">
        <span>A = 0.0276 h<sub>R</sub><sup>0.725</sup> m<sub>R</sub><sup>0.425</sup> + 0.1647</span><br />
      </div>
      <p>
        Where <span class="formula">m<sub>R</sub></span> is the mass of the rider (which is normalized
        to <span class="formula">67 kg</span> for male riders and for <span class="formula">53 kg</span>
        female riders) and <span class="formula">h<sub>R</sub></span> is the height of the rider. If we
        normalize height to be <span class="formula">1.80 m</span> for male riders we get a
        <span class="formula">C<sub>D</sub>A</span> in the drops of <span class="formula">0.367</span> which
        seems high - we would expect the value to be closer to <span class="formula">0.3</span> for a cyclist
        in the drops to match empirically determined numbers. As such, for <span class="formula">PERF</span>,
        we assume a <span class="formula">C<sub>D</sub>A</span> of <span class="formula">0.325</span> for men
        (<span class="formula">0.300</span> for women, rounded from <span class="formula">0.297</span> which is
        what we get after scaling <span class="formula">0.325</span> to account for the smaller body size) to
        represent a climbing cyclist who spends time in the drops/hoods/tops but attempts to maintain as
        aggressive a position as possible for the duration of the effort.
      </p>
      <p>
        In order to arrive at a rating for this value we can compare the performance
        <a href="https://www.trainingpeaks.com/blog/power-profiling/">Coggan’s table</a> of what
        cyclists of various levels should be able to produce. These values can be thought of as the
        ‘base’ performance used in the models used by FINA and the IAAF. The values at the top of this
        table can be used to fit the CP model and we can then project what the expected ‘World Record’
        power-to-weight ratio would be for any given duration for male or female riders:
      </p>
      <div class="formula">
        <span>CP<sub>M</sub> = 422.58 + 23296.7801287949/t</span><br />
        <span>CP<sub>F</sub> = 298.29 + 13499.9080036799/t</span><br />
      </div>
      <p>
        Finally, in order to come up with a rating between 0-1000 points, we simply use these critical
        power formulas (adjusted for median altitude using <span class="formula">P<sub>ALT</sub></span>)
        and the simplified <span class="formula">P<sub>TOT</sub></span> formula to come up with a <span
        class="formula">t<sub>WR</sub></span> for a given climb and then use a modified version of FINA’s
        formula to compare it to a performance of duration <span class="formula">t</span>. Instead of
        <em>cubing</em> the difference between <span class="formula">t<sub>WR</sub></span> and <span
        class="formula">t</span>, we instead <em>square</em> it in order to give us a rating which rewards
        more points to sub-‘World Record’ performances. Because <span class="formula">PERF</span> is
        intended to be used to rank amateur performances, this adjustment helps ensure a more reasonable
        spread for the typical data points we deal with.
      </p>
      <div class="formula">
        <span>1000 (t<sub>WR</sub> / t)<sup><strong>2</strong></sup></span><br />
      </div>
      <h2 id="considerations">Considerations</h2>
      <h2 id="examples">Examples</h2>
      <p>
        In order to verify PERF as efficacious, it is instructive to see how it scores performances
        across several benchmark climbs:
      </p>
      <h3>Old La Honda</h3>
      <p>
        <a href="https://www.strava.com/segments/8109834">Old La Honda</a> (OLH) is a benchmark climb in
        the Bay Area, climbing 390m in 4.80km according to Strava (<a
        href="https://graphics.stanford.edu/~lucasp/grade/oldlahonda.html">alternative measurements</a>
        end up being significantly different - for our purposes Strava is the authority for these
        examples). Similar to a 5000m running race in athletics, strong amateur performances on OLH are in
        the 14:30-15:00 range, with the best time from a retired professional currently standing at 13:26.
        <span class="formula">PERF</span> projects the <span class="formula">t<sub>WR</sub></span> to be
        12:50 for a motivated World Tour professional, a time which is in line with a typical WL
         performance in the 5000m on the track. For women, a time of 14:50 would score 1000 points.
      </p>
      <p>
        OLH (along with Alpe d’Huez) is one of the climbs used to help determine the ‘slope’ of <span
        class="formula">PERF</span> - the coefficient of <span class="formula">2</span> in the scoring
        function was chosen so that a time for men close to 18:00 (4.5 W/kg) would be worth around 500
        points (508). Furthermore, when we convert the best amateur female time (17:00) we get 14:42,
        which compares favorably to the best male amateur times (14:40-15:00). As another form of
        verification, we can compare OLH times to another benchmark climb in the Bay Area - a 17:00 OLH
        is deemed to be roughly equivalent to a 22:41 <a href="https://www.strava.com/segments/611413">
        Kings Mountain</a> time.
      </p>
      <h3>Alpe d'Huez</h3>
      <p>
        Perhaps the most famous climb of the Tour de France (and cycling),
        <a href="https://www.strava.com/segments/683473">Alpe d’Huez</a> climbs 1099m in 13.91km. The
        <a href="http://www.fillarifoorumi.fi/forum/showthread.php?38129-Ammattilaispy%F6r%E4ilij%F6iden-nousutietoja-(aika-km-h-VAM-W-W-kg-etc-)&p=2041608#post2041608">
        list of best performances</a> is rife with suspect times, but a time somewhere in the range of Carlos
        Sastre’s 39:01 in 2006 and Nairo Quintana’s 39:50 in 2013 seems like it could plausibly be
        considered the world’s best clean performance. <span class="formula">PERF</span> predicts a time
        of 39:04 as the best male performance (44:46 for females).
      </p>
      <p>
        Like with OLH, Alpe d’Huez was used to adjust the coefficient of the scoring function - a 57:00
        performance would be performed at FTP and would take 4 W/kg - we would wish for <span
        class="formula">PERF</span> to give this close to 500 points (<span class="formula">PERF</span>
        rewards a 55:16 male performance with 500 points).
      </p>
      <h3>Others</h3>
      <p>
      Egan Bernal’s <a href="https://www.strava.com/activities/1576474365#39408611839">27:12</a> on <a
      href="https://www.strava.com/segments/658277" >Gibraltr Road</a> during the 2018 Tour of California is
      very close to the <span class="formula">t<sub>WR</sub></span> predicted by <span class="formula">PERF</span>
      (27:06). <span class="formula">PERF</span> predicts a 31:54 best time on <a href="https://www.strava.com/segments/2363">
      Col de la Madone</a> which falls in the middle of the times claimed by
      <a href="http://www.cyclingweekly.com/news/latest-news/la-madone-tour-contenders-favourite-testing-ground-197321">
      Armstrong, Froome and Porte</a> and the <a href="https://www.strava.com/activities/370233568#8845011061">
      current best professional time on Strava</a>. Chris Froome’s remarkable
      <a href="http://www.fillarifoorumi.fi/forum/showthread.php?38129-Ammattilaispy%F6r%E4ilij%F6iden-nousutietoja-(aika-km-h-VAM-W-W-kg-etc-)&p=2045251#post2045251">
      Ax-3 Domaines</a> performance in the 2013 Tour of 23:14 slightly exceeds the projected <span class="formula">
      t<sub>WR</sub></span> of 23:29, and the predicted bests of 47:22 for
      <a href="http://www.fillarifoorumi.fi/forum/showthread.php?38129-Ammattilaispy%F6r%E4ilij%F6iden-nousutietoja-(aika-km-h-VAM-W-W-kg-etc-)&p=2061073#post2061073">
      Ventoux</a> and 38:54 for
      <a href="http://www.fillarifoorumi.fi/forum/showthread.php?38129-Ammattilaispy%F6r%E4ilij%F6iden-nousutietoja-(aika-km-h-VAM-W-W-kg-etc-)&p=2218881#post2218881">
      Zoncolan</a> are both in the ballpark of what one might claim are reasonably achievable clean.
      </p>
    </div>
  </body>
</html>
