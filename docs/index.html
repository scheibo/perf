<!doctype html>
<html lang=en>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>PERF</title>
    <style>
      #content {
        font-family: "Roboto", "Helvetica Neue", "Helvetica", "Arial", sans-serif;
        padding-top: 0.5em;
        margin: 2em auto;
        max-width: 690px;
        line-height: 1.4em;
      }
      .formula {
        font-family: monospace;
        line-height: 1em;
      }
      div.formula {
        text-align: center;
        line-height: 1.3em;
      }
      h1 {
        margin-bottom: 0.5em;
      }
      .subtitle {
        font-size: 1.2em;
        color: #666;
        padding-bottom: 0.67em;
      }
    </style>
  </head>
  <body>
    <div id="content">
      <h1>PERF</h1>
      <div class="subtitle"><strong>P</strong>erformance
          <strong>E</strong>quivalency
          <strong>R</strong>ating
          <strong>F</strong>ormula</div>

      <h2 id="motivation">Motivation</h2>
      <p>
        The desire to rank and compare performances is universal across sports, be it to answer the
        question of whether Michael Jordan or LeBron James was the better basketball player, what
        1968 Jim Ryun’s mile time would be on a modern, synthetic track, or whether Katie Ledecky’s
        or Michael Phelps’ victories were more impressive. However, accurately comparing such
        performances is difficult and error prone - in all cases we must acknowledge that we will
        never be able to come up with a definitive answer, the best we can do is come up with
        metrics to guide the discussion and add a layer of scientific nuance to arguments.
      </p>

      <h2 id="background">Background</h2>
      <p>
        In swimming and track and field, the governing bodies (FINA and the IAAF, respectively)
        publish ‘points’ tables which can be used to rank performances. <a
        href="https://www.fina.org/sites/default/files/fina_points_table_2.pdf">FINA’s model</a> is
        based on comparing a event performance’s time to the current world record for that event (the
        ‘base’ performance) and applying a cubic function to arrive at a points total:
      </p>
      <div class="formula">
        <span>1000 (t<sub>WR</sub> / t)<sup>3</sup></span><br />
      </div>
      <p>
        The IAAF tables are based on Dr. Bojidar Spiriev’s Hungarian Scoring Table model which also
        calculates a score based on a base performance and several constants:
      </p>
      <div class="formula">
        <span>a (t - t<sub>b</sub>)<sup>c</sup></span><br />
      </div>
      <p>
        Where <span class="formula">a</span>, <span class="formula">t<sub>b</sub> </span> (the base
        performance) and <span class="formula">c</span> vary based on the event. Mick Bromilow’s “<a
        href="https://www.southernathletics.org.uk/assets/files/bromilowscoring.docx">Towards a
        fairer scoring system in athletics</a>” points out some issues and suggests improvements for
        this approach, and there are numerous other systems for evaluating or predicting performance in
        athletics (<a href="http://www.cs.uml.edu/~phoffman/xcinfo3.html">Gardner-Purdy points</a>,
        <a href="http://runsmartproject.com/calculator/">Daniels’ VDOT</a>,
        <a href="https://www.mcmillanrunning.com/ ">McMillan’s calculator</a>,
        <a href="http://myweb.lmu.edu/jmureika/track/mercier/instructions.html ">Mercier Score</a>),
        as well for adjusting for <a href="http://www.cs.uml.edu/~phoffman/wind.html">wind or altitude</a>.
      </p>
      <p>
        Comparing road cycling performance is significantly more difficult than swimming or
        athletics - road races take place over varying terrain and venues without any standard event
        distances. Importantly, weather conditions, in particular wind, have a substantially larger
        impact on performance than in other sports due to the speeds reached during competition and
        the quadratic nature of aerodynamic drag. As such, coming up with a formula to compare any
        given cycling performance with another is a nonstarter. However, if we restrict the domain
        to just comparing cycling <em>climbing</em> performance we can minimize the impact of many
        confounding factors and come up with a rough model to use for comparison purposes.
      </p>
      <p>
        Comparing cycling climbing performance is not a new idea - Michele Ferrari coined <a
        href="https://en.wikipedia.org/wiki/VAM_(bicycling)">VAM</a> (<em>velocità ascensionale
        media</em>) for comparing climbing speed, and Scott Richards &amp; Dr. Michael Puchowicz
        (<a href="https://veloclinic.com">Veloclinic</a>) have developed models
        (<a href="http://www.cyclismas.com/biscuits/a-different-approach-to-comparing-climbing-performances/">pVAM</a>,
        <a href="http://www.cyclismas.com/biscuits/introducing-pvgrad-yes-another-performance-meter/">pVGRAD</a>)
        for predicting climbing performance. Critics have used these models to argue whether or not a
        performance was ‘too good to be true’, but these allegations need to be taken with a grain of
        salt - the models are <a href="https://wattmatters.blog/home/2013/07/windbags.html">subject</a>
        <a href="https://wattmatters.blog/home/2010/07/ascent-rates-and-power-to-body-mass.html">to</a>
        <a href="http://djconnel.blogspot.com/2013/07/pvam-and-critical-power-model.html">flaws</a> and
        <a href="https://wattmatters.blog/home/2013/07/the-elusive-dopeometer.html">don’t</a>
        <a href="https://wattmatters.blog/home/2013/07/all-things-in-moderation-except-science.html">have</a>
        <a href="http://sportsscientists.com/2010/07/tour-power-output-reflections/">the</a>
        <a href="http://sportsscientists.com/2013/07/on-performance-analysis-common-sense-guided/">power</a>
        to be able to definitively brand a rider as a doper. More recently, the trend has shifting to
        relying on more scientifically backed models for quantifying cycling climbing performances.
      </p>
      <p>
        Puchowicz’s current approach relies on <a href="https://www.ncbi.nlm.nih.gov/pubmed/28121252">Martin’s mathematical model</a>
        for calculating cycling power, normalized for typical weight and conditions and corrected for
        altitude using <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5362642/">Townsend’s model</a>
        which relies on <a href="https://www.tandfonline.com/doi/abs/10.1080/00140136508930810">Monod and
        Scherrer’s seminal Critical Power (CP) model</a>. This can be used to calculate an estimated,
        normalized W/kg for a rider, which can then be compared to other performances of the same duration.
      </p>

      <h2 id="details">Details</h2>
      <p>
        Puchowicz’s work provides an excellent starting point for development of
        ‘<span class="formula">PERF</span>’, a formula for comparing cycling performance across various
        climbing durations. However, while Puchowicz’s approach is mainly concerned with estimating and
        comparing Tour de France climbing performances during the race, <span class="formula">PERF</span>
        aims to also rate one-off efforts by amateur cyclists. Like with FINA/IAAF points tables, a
        world class performance should rate around 1000 points, with less impressive performances
        earning progressively less points.
      </p>
      <p>
        <span class="formula">PERF</span> begins by deriving an altitude-adjusted estimation for
        normalized power-to-weight ratio (W/kg) based on Martin’s and Townsend’s models:
      </p>
      <div class="formula">
        <span>P<sub>AT</sub> = 1/2 ρ (C<sub>D</sub> A + F<sub>W</sub>) V<sub>a</sub><sup>2</sup> V<sub>G</sub></span><br />
        <span>P<sub>RR</sub> = V<sub>G</sub> cos[tan<sup>-1</sup>(G<sub>R</sub>)] C<sub>RR</sub> m<sub>T</sub> g</span><br />
        <span>P<sub>WB</sub> = V<sub>G</sub> (91 + 8.7 V<sub>G</sub>) / 1000</span><br />
        <span>P<sub>PE</sub> = V<sub>G</sub> m<sub>T</sub> g sin[tan<sup>-1</sup>(G<sub>R</sub>)]</span><br />
        <span>P<sub>KE</sub> = 1/2 (m<sub>T</sub> + I/r<sup>2</sup>) (V<sub>Gf</sub><sup>2</sup> - V<sub>Gi</sub><sup>2</sup>) / (t<sub>i</sub> - t<sub>f</sub>) </span><br />
        <span>P<sub>TOT</sub> = (P<sub>AT</sub> + P<sub>RR</sub> + P<sub>WB</sub> + P<sub>PE</sub> + P<sub>KE</sub>) / E<sub>c</sub></span><br />
        <br />
        <span>m<sub>T</sub> = m<sub>R</sub> + m<sub>B</sub></span><br />
        <span>ρ = (p<sub>0</sub> (1 - Lh/T<sub>0</sub>)<sup>(gM)/(RL)</sup>M)/(R(T<sub>0</sub> - Lh))</span><br />
        <br />
        <span>P<sub>ALT</sub> = P (0.0016x<sup>3</sup> + 0.0157x<sup>2</sup> + 0.027x + 1.0025)</span><br />
      </div>
      <p>
        Where <span class="formula">C<sub>RR</sub></span>, <span class="formula">E<sub>C</sub></span>,
        <span class="formula">g</span>, <span class="formula">F<sub>w</sub></span>, <span class="formula">T
        <sub>0</sub></span>, <span class="formula">p<sub>0</sub></span>, <span class="formula">L</span>,
        <span class="formula">M</span>, <span class="formula">R</span> are all constants with
        standard, well defined values, and the <span class="formula">m<sub>B</sub></span> is assumed
        to be <span class="formula">8 kg</span> (<span class="formula">6.8 kg</span> is the UCI limit
        for a bicycle, and then we need to account for clothes/helmet/shoes etc). Puchowicz simplifies
        these equations by assuming there is no change in kinetic energy (ie. the rider doesn’t need
        to accelerate into the base of the climb and thus <span class="formula">P<sub>KE</sub></span>
        is zero), assumes there is no wind (see ‘<a href="#considerations">Considerations</a>’ below),
        so air velocity is equal to the ground velocity (<span class="formula">V<sub>a</sub> =
        V<sub>G</sub></span>), when calculating <span class="formula">P<sub>AT</sub></span>, and
        derives the density of air (<span class="formula">ρ</span> ) based on the median altitude <span
        class="formula">h</span>.  Puchowicz actually goes even further and ignores the contributions
        related to wheel bearing friction (<span class="formula">P<sub>WB</sub></span>) given that they
        are fairly negligible, but for completeness we leave this factor in the model for <span
        class="formula">PERF</span>.
      </p>
      <p>
        The aerodynamic drag (<span class="formula">C<sub>D</sub>A</span>) depends on the coefficient of
        drag (<span class="formula">C<sub>D</sub></span>) for a cyclist which from “Bicycling Science”
        (Wilson, 2004) can be <span class="formula">0.88</span>/<span class="formula">1.0</span>/<span
        class="formula">1.15</span> depending on the whether the rider is in the drops/hoods/tops
        respectively (Puchowicz uses <span class="formula">0.84</span>). For these same positions the
        respective frontal area (<span class="formula">A</span>) is
        <span class="formula">0.36</span>/<span class="formula">0.40</span>/<span class="formula">0.632</span>.
        Alternatively, area can be derived from the historically observed relationship between a rider’s height
        and weight and his frontal area in the drops:
      </p>
      <div class="formula">
        <span>A = 0.0276 h<sub>R</sub><sup>0.725</sup>  m<sub>R</sub><sup>0.425</sup> + 0.1647</span><br />
      </div>
      <p>
        Where <span class="formula">m<sub>R</sub></span> is the mass of the rider (which is normalized
        to <span class="formula">67 kg</span> for male riders and for <span class="formula">53 kg</span>
        female riders) and <span class="formula">h<sub>R</sub></span> is the height of the rider. If we
        normalize height to be <span class="formula">1.80 m</span> for male riders we get a 
        <span class="formula">C<sub>D</sub>A</span> in the drops of <span class="formula">0.367</span> which
        seems high - we would expect the value to be closer to <span class="formula">0.3</span> for a cyclist
        in the drops to match empirically determined numbers. As such, for <span class="formula">PERF</span>,
        we assume a <span class="formula">C<sub>D</sub>A</span> of <span class="formula">0.325</span> for men
        (<span class="formula">0.300</span> for women, rounded from <span class="formula">0.297</span> which is
        what we get after scaling <span class="formula">0.325</span> to account for the smaller body size) to
        represent a climbing cyclist who spends time in the drops/hoods/tops but attempts to maintain as
        aggressive a position as possible for the duration of the effort.
      </p>
      <p>
        In order to arrive at a rating for this value we can compare the performance
        <a href="https://www.trainingpeaks.com/blog/power-profiling/">Coggan’s table</a> of what cyclists of various
        levels should be able to produce. These values can be thought of as the ‘base’ performance used
        in the models used by FINA and the IAAF. The values at the top of this table can be used to fit
        the CP model and we can then project what the expected ‘World Record’ power-to-weight ratio
        would be for any given duration for male or female riders:
      </p>
      <div class="formula">
        <span>CP<sub>M</sub> = 422.58 + 23296.7801287949/t</span><br />
        <span>CP<sub>F</sub> = 298.29 + 13499.9080036799/t</span><br />
      </div>
      <p>
        Finally, in order to come up with a rating between 0-1000 points, we simply use these critical
        power formulas (adjusted for median altitude using <span class="formula">P<sub>ALT</sub></span>)
        and the simplified <span class="formula">P<sub>TOT</sub></span> formula to come up with a <span
        class="formula">t<sub>WR</sub></span> for a given climb and then use FINA’s formula to compare it
        to a performance of duration <span class="formula">t</span>.
      </p>
      <h2 id="considerations">Considerations</h2>
      <h2 id="examples">Examples</h2>
    </div>
  </body>
</html>
